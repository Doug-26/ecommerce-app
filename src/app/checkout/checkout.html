<div class="checkout-container">
  <div class="container py-4">
    
    <!-- Step Progress Indicator -->
    <div class="row justify-content-center mb-5">
      <div class="col-md-10">
        <div class="d-flex justify-content-between align-items-center">
          
          <!-- Step 1: Shipping -->
          <div class="text-center" [class]="currentStep() === 1 ? 'text-primary' : currentStep() > 1 ? 'text-success' : 'text-muted'">
            <div class="step-circle mb-2" 
                 [class]="currentStep() === 1 ? 'bg-primary text-white' : currentStep() > 1 ? 'bg-success text-white' : 'bg-light text-muted'">
              @if (currentStep() > 1) {
                ✓
              } @else {
                1
              }
            </div>
            <small>Shipping</small>
          </div>

          <!-- Line -->
          <div class="flex-fill mx-3" style="height: 2px;" 
               [class]="currentStep() > 1 ? 'bg-success' : 'bg-light'"></div>

          <!-- Step 2: Payment -->
          <div class="text-center" [class]="currentStep() === 2 ? 'text-primary' : currentStep() > 2 ? 'text-success' : 'text-muted'">
            <div class="step-circle mb-2"
                 [class]="currentStep() === 2 ? 'bg-primary text-white' : currentStep() > 2 ? 'bg-success text-white' : 'bg-light text-muted'">
              @if (currentStep() > 2) {
                ✓
              } @else {
                2
              }
            </div>
            <small>Payment</small>
          </div>

          <!-- Line -->
          <div class="flex-fill mx-3" style="height: 2px;"
               [class]="currentStep() > 2 ? 'bg-success' : 'bg-light'"></div>

          <!-- Step 3: Review -->
          <div class="text-center" [class]="currentStep() === 3 ? 'text-primary' : currentStep() > 3 ? 'text-success' : 'text-muted'">
            <div class="step-circle mb-2"
                 [class]="currentStep() === 3 ? 'bg-primary text-white' : currentStep() > 3 ? 'bg-success text-white' : 'bg-light text-muted'">
              @if (currentStep() > 3) {
                ✓
              } @else {
                3
              }
            </div>
            <small>Review</small>
          </div>

        </div>
      </div>
    </div>

    <!-- Step Content -->
    <div class="row justify-content-center">
      <div class="col-md-8">
        
        @switch (currentStep()) {
          @case (1) {
            <app-checkout-shipping 
              (onContinue)="onShippingComplete()"
              (back)="onShippingBack()">
            </app-checkout-shipping>
          }
          @case (2) {
            <app-checkout-payment 
              (continue)="onPaymentComplete()" 
              (back)="onPaymentBack()">
            </app-checkout-payment>
          }
          @case (3) {
            <app-checkout-review 
              (placeOrder)="onOrderComplete()" 
              (back)="onReviewBack()">
            </app-checkout-review>
          }
          @case (4) {
            <app-checkout-success></app-checkout-success>
          }
          @default {
            <div class="alert alert-warning">
              Invalid step: {{ currentStep() }}
              <button class="btn btn-link" (click)="checkoutService.goToStep(1)">Reset to Step 1</button>
            </div>
          }
        }

      </div>
    </div>

  </div>
</div>
